<!DOCTYPE html>
<html>
  <head>
    <title>React Weather App</title>
    <style>
      body {
        margin: 0;
        font-family: Arial, sans-serif;
        background-color: lightblue;
        display: flex;
        justify-content: center;
        align-items: center;
        min-height: 100vh;
      }

      input, button {
        margin: 5px;
        padding: 10px 15px;
        border-radius: 10px;
        border: none;
        outline: none;
        font-size: 16px;
      }

      button {
        cursor: pointer;
        background-color: #2196F3;
        color: white;
      }

      .weather {
        background-color: white;
        padding: 20px;
        border-radius: 15px;
        box-shadow: 0 4px 10px rgba(0,0,0,0.2);
        text-align: center;
        max-width: 400px;
        margin-top: 20px;
      }

      img {
        width: 100px;
      }
    </style>
  </head>
  <body>
    <div class="js-container"></div>

    <script src="https://unpkg.com/supersimpledev/react.js"></script>
    <script src="https://unpkg.com/supersimpledev/react-dom.js"></script>
    <script src="https://unpkg.com/supersimpledev/babel.js"></script>

    <script type="text/babel">
      const { useState, useEffect } = React;

      function App() {
      const [isLoading, setIsLoading] = useState(false);
const [error, setError] = useState(null);
        const [inputS, setInputS] = useState("");
        const [weather, setWeather] = useState(null);
        const [bg, setBg] = useState("lightblue");
        const apiKey = "4b7be568f0e023dfd6bb779e3c086ef9";

        // Load saved weather from localStorage
        useEffect(() => {
          const saved = localStorage.getItem("weathered");
          if (saved) {
            const data = JSON.parse(saved);
            setWeather(data);
            setBg(getBackground(data.conditionMain));
          }
        }, []);

        // Save weather to localStorage whenever it changes
        useEffect(() => {
          if (weather) localStorage.setItem("weathered", JSON.stringify(weather));
        }, [weather]);

      function getBackground(condition) {
          switch(condition) {
            case "Clear": return "skyblue";
            case "Clouds": return "lightgray";
            case "Rain": return "lightblue";
            case "Snow": return "white";
            case "Thunderstorm": return "darkgray";
            default: return "lightgreen";
          }
        } 


        function AddSearch() {
  if (inputS.trim() === "") return alert("Please enter a city name");

  setIsLoading(true);  // start loading
  setError(null);      // reset previous error

  fetch(`https://api.openweathermap.org/data/2.5/weather?q=${inputS}&appid=${apiKey}&units=metric`)
    .then(res => res.json())
    .then(data => {
      if (data.cod === 200) {
        const newWeather = {
          city: data.name,
          temp: data.main.temp,
          condition: data.weather[0].description,
          conditionMain: data.weather[0].main,
          icon: data.weather[0].icon,
          feels_like: data.main.feels_like,
          humidity: data.main.humidity,
          wind: data.wind.speed * 3.6
        };
        setWeather(newWeather);
        setBg(getBackground(newWeather.conditionMain));
      } else {
        setWeather(null);
        setBg("lightblue");
        setError("City not found");  // set error message
      }
      setInputS("");
    })
    .catch(err => {
      console.error(err);
      setError("Error fetching data"); // network or other error
      setWeather(null);
      setBg("lightblue");
    })
    .finally(() => {
      setIsLoading(false); // stop loading
    });
}
        return (
          <>
          <div>
  <input
    placeholder="Enter city name"
    value={inputS}
    onChange={e => setInputS(e.target.value)}
  />
  <button onClick={AddSearch}>Search</button>
</div>

{/* Loading state */}
{isLoading && <p>Loading...</p>}

{/* Error state */}
{error && <p style={{ color: "red" }}>{error}</p>}

{/* Weather info */}
{weather && (
  <div className="weather" style={{ backgroundColor: bg }}>
    <h2>City: {weather.city}</h2>
    <p>Temperature: {weather.temp}°C</p>
    <p>Condition: {weather.condition}</p>
    <img
      src={`https://openweathermap.org/img/wn/${weather.icon}.png`}
      alt={weather.condition}
    />
    <p>Feels like: {weather.feels_like}°C</p>
    <p>Humidity: {weather.humidity}%</p>
    <p>Wind: {weather.wind.toFixed(1)} km/h</p>
  </div>
)}
          </>
        );
      }

      ReactDOM.render(<App />, document.querySelector(".js-container"));
    </script>
  </body>
</html>